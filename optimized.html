<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ë§›ìˆëŠ” ê¸‰ì‹">
    <meta name="theme-color" content="#f3e8ff">
    <title>ë§›ìˆëŠ” ê¸‰ì‹ ğŸ±</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

// ==========================================
// ğŸ”‘ API í‚¤ ì„¤ì •
// ==========================================
// ì•„ë˜ì— NEIS ì˜¤í”ˆ APIì—ì„œ ë°œê¸‰ë°›ì€ ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”.
// 
// ğŸ“ API í‚¤ ë°œê¸‰ ë°©ë²•:
// 1. https://open.neis.go.kr ì ‘ì†
// 2. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
// 3. 'ì¸ì¦í‚¤ ì‹ ì²­' ë©”ë‰´ì—ì„œ ì‹ ì²­
// 4. ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ì•„ë˜ YOUR_API_KEY_HERE ë¶€ë¶„ì— ë¶™ì—¬ë„£ê¸°
// 
// ì˜ˆì‹œ: const NEIS_API_KEY = 'abc123def456ghi789jkl012mno345pqr678stu901';
// ==========================================

const NEIS_API_KEY = '6c95ddeef5e0436893e707bf07c7dfc5';

// ==========================================

const SchoolLunchApp = () => {
  const [schoolName, setSchoolName] = useState('');
  const [searchResults, setSearchResults] = useState([]);
  const [selectedSchool, setSelectedSchool] = useState(null);
  const [selectedDate, setSelectedDate] = useState(new Date());
  const [mealData, setMealData] = useState(null);
  const [weeklyData, setWeeklyData] = useState([]);
  const [loading, setLoading] = useState(false);
  const [searchLoading, setSearchLoading] = useState(false);
  const [viewMode, setViewMode] = useState('daily'); // 'daily' or 'weekly'
  const [showSettings, setShowSettings] = useState(false);
  const [settingsSchoolInput, setSettingsSchoolInput] = useState('');
  const [settingsSearchResults, setSettingsSearchResults] = useState([]);
  const [settingsSearchLoading, setSettingsSearchLoading] = useState(false);
  const [showInfo, setShowInfo] = useState(false);

  // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ìë™ ì¡°íšŒ ì œê±°)
  useEffect(() => {
    const savedDefaultSchool = localStorage.getItem('schoolLunchDefaultSchool');
    
    // ê¸°ë³¸ í•™êµê°€ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ë¡œë“œ (ê¸‰ì‹ ì¡°íšŒëŠ” í•˜ì§€ ì•ŠìŒ)
    if (savedDefaultSchool) {
      const defaultSchool = JSON.parse(savedDefaultSchool);
      setSelectedSchool(defaultSchool);
      setSchoolName(defaultSchool.name);
    }
  }, []);

  // ìŒì‹ ì´ëª¨ì§€ ë§¤ì¹­
  const getFoodEmoji = (foodName) => {
    const emojiMap = {
      'ë°¥': 'ğŸš', 'ìŒ€': 'ğŸŒ¾', 'ì¡ê³¡': 'ğŸŒ¾',
      'ê¹€ì¹˜': 'ğŸ¥¬', 'ë°°ì¶”': 'ğŸ¥¬', 'ê¹ë‘ê¸°': 'ğŸ¥•',
      'êµ­': 'ğŸ²', 'ì°Œê°œ': 'ğŸ²', 'íƒ•': 'ğŸ²',
      'ë‹­': 'ğŸ—', 'ì¹˜í‚¨': 'ğŸ—',
      'ë¼ì§€': 'ğŸ¥“', 'ì‚¼ê²¹ì‚´': 'ğŸ¥“', 'ëª©ì‚´': 'ğŸ¥“',
      'ì†Œê³ ê¸°': 'ğŸ¥©', 'ë¶ˆê³ ê¸°': 'ğŸ¥©', 'ìŠ¤í…Œì´í¬': 'ğŸ¥©',
      'ìƒì„ ': 'ğŸŸ', 'ê³ ë“±ì–´': 'ğŸŸ', 'ê°ˆì¹˜': 'ğŸŸ', 'ì‚¼ì¹˜': 'ğŸŸ',
      'ìƒˆìš°': 'ğŸ¦', 'ì˜¤ì§•ì–´': 'ğŸ¦‘',
      'ê³„ë€': 'ğŸ¥š', 'ë‹¬ê±€': 'ğŸ¥š',
      'ë‘ë¶€': 'ğŸ§ˆ', 'ì½©': 'ğŸ«˜',
      'ë‹¹ê·¼': 'ğŸ¥•', 'ë¸Œë¡œì½œë¦¬': 'ğŸ¥¦',
      'ê³ êµ¬ë§ˆ': 'ğŸ ', 'ê°ì': 'ğŸ¥”',
      'ìš°ìœ ': 'ğŸ¥›', 'ìš”êµ¬ë¥´íŠ¸': 'ğŸ¥›',
      'ê³¼ì¼': 'ğŸ', 'ì‚¬ê³¼': 'ğŸ', 'ë°°': 'ğŸ', 'ê·¤': 'ğŸŠ', 'ë°”ë‚˜ë‚˜': 'ğŸŒ',
      'ë”¸ê¸°': 'ğŸ“', 'ìˆ˜ë°•': 'ğŸ‰', 'í¬ë„': 'ğŸ‡',
      'ë¹µ': 'ğŸ', 'ìƒŒë“œìœ„ì¹˜': 'ğŸ¥ª',
      'ìŠ¤íŒŒê²Œí‹°': 'ğŸ', 'íŒŒìŠ¤íƒ€': 'ğŸ',
      'í”¼ì': 'ğŸ•', 'í–„ë²„ê±°': 'ğŸ”',
      'ë–¡': 'ğŸ¡', 'ë–¡ë³¶ì´': 'ğŸ¡',
      'ë§Œë‘': 'ğŸ¥Ÿ', 'êµ°ë§Œë‘': 'ğŸ¥Ÿ',
      'ì¹´ë ˆ': 'ğŸ›', 'ë³¶ìŒë°¥': 'ğŸ›',
      'ìƒëŸ¬ë“œ': 'ğŸ¥—', 'ìƒì¶”': 'ğŸ¥—',
      'ê¹€': 'ğŸŸ¢', 'ë¯¸ì—­': 'ğŸŸ¢',
      'ë¼ë©´': 'ğŸœ', 'ìš°ë™': 'ğŸœ',
    };

    for (const [key, emoji] of Object.entries(emojiMap)) {
      if (foodName.includes(key)) return emoji;
    }
    return 'ğŸ½ï¸';
  };

  // ì•Œë ˆë¥´ê¸° ì •ë³´ í•˜ì´ë¼ì´íŠ¸
  const highlightAllergens = (text) => {
    const allergens = ['ëŒ€ë‘', 'ë°€', 'ìš°ìœ ', 'ê³„ë€', 'ë•…ì½©', 'ìƒˆìš°', 'ê²Œ', 'ì˜¤ì§•ì–´', 'ê³ ë“±ì–´', 'ë¼ì§€ê³ ê¸°', 'ë³µìˆ­ì•„', 'í† ë§ˆí† '];
    let highlighted = text;
    
    allergens.forEach(allergen => {
      if (text.includes(allergen)) {
        highlighted = highlighted.replace(
          new RegExp(allergen, 'g'),
          `<span class="allergen">${allergen}</span>`
        );
      }
    });
    
    return highlighted;
  };

  // ë‚ ì§œ í¬ë§·íŒ… (YYYYMMDD)
  const formatDate = (date) => {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}${month}${day}`;
  };

  // ë‚ ì§œ inputìš© í¬ë§·íŒ… (YYYY-MM-DD)
  const formatDateForInput = (date) => {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  };

  // í•™êµëª…ìœ¼ë¡œ ê²€ìƒ‰
  const searchSchools = async (name) => {
    if (!name || name.trim().length < 2) {
      setSearchResults([]);
      return;
    }

    setSearchLoading(true);
    try {
      const url = `https://open.neis.go.kr/hub/schoolInfo?KEY=${NEIS_API_KEY}&Type=json&pIndex=1&pSize=100&SCHUL_NM=${encodeURIComponent(name)}`;
      
      const response = await fetch(url);
      const data = await response.json();
      
      if (data.schoolInfo && data.schoolInfo[1]) {
        const schools = data.schoolInfo[1].row;
        setSearchResults(schools);
      } else {
        setSearchResults([]);
      }
    } catch (error) {
      console.error('Error searching schools:', error);
      setSearchResults([]);
    }
    setSearchLoading(false);
  };

  // í•™êµ ì„ íƒ
  const selectSchool = (school) => {
    const schoolData = {
      name: school.SCHUL_NM,
      officeCode: school.ATPT_OFCDC_SC_CODE,
      schoolCode: school.SD_SCHUL_CODE,
      address: school.ORG_RDNMA || school.ORG_RDNMA,
    };
    setSelectedSchool(schoolData);
    setSchoolName(school.SCHUL_NM);
    setSearchResults([]);
    
    // ìë™ìœ¼ë¡œ ê¸°ë³¸ í•™êµë¡œ ì €ì¥
    localStorage.setItem('schoolLunchDefaultSchool', JSON.stringify(schoolData));
  };

  // ê¸‰ì‹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  const fetchMealData = async (date) => {
    if (!selectedSchool) {
      alert('í•™êµë¥¼ ë¨¼ì € ê²€ìƒ‰í•˜ê³  ì„ íƒí•´ì£¼ì„¸ìš”!');
      return;
    }

    setLoading(true);
    try {
      const dateStr = formatDate(date);
      console.log('ğŸ” ê¸‰ì‹ ì¡°íšŒ - ë‚ ì§œ:', date, 'í¬ë§·ëœ ë‚ ì§œ:', dateStr);
      const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${NEIS_API_KEY}&Type=json&pIndex=1&pSize=100&ATPT_OFCDC_SC_CODE=${selectedSchool.officeCode}&SD_SCHUL_CODE=${selectedSchool.schoolCode}&MLSV_YMD=${dateStr}`;
      
      const response = await fetch(url);
      const data = await response.json();
      console.log('ğŸ“Š API ì‘ë‹µ:', data);
      
      if (data.mealServiceDietInfo && data.mealServiceDietInfo[1]) {
        const meals = data.mealServiceDietInfo[1].row;
        // ì¤‘ì‹ë§Œ í•„í„°ë§
        const lunchData = meals.find(meal => meal.MMEAL_SC_NM === 'ì¤‘ì‹') || meals[0];
        setMealData(lunchData);
      } else {
        setMealData(null);
      }
    } catch (error) {
      console.error('Error fetching meal data:', error);
      alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í•™êµë¥¼ ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.');
    }
    setLoading(false);
  };

  // ì£¼ê°„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  const fetchWeeklyData = async () => {
    if (!selectedSchool) return;

    setLoading(true);
    const weekly = [];
    const startDate = new Date(selectedDate);
    startDate.setDate(startDate.getDate() - startDate.getDay()); // ì£¼ì˜ ì‹œì‘ì¼ (ì¼ìš”ì¼)

    for (let i = 0; i < 7; i++) {
      const currentDate = new Date(startDate);
      currentDate.setDate(startDate.getDate() + i);
      
      try {
        const dateStr = formatDate(currentDate);
        const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${NEIS_API_KEY}&Type=json&pIndex=1&pSize=100&ATPT_OFCDC_SC_CODE=${selectedSchool.officeCode}&SD_SCHUL_CODE=${selectedSchool.schoolCode}&MLSV_YMD=${dateStr}`;
        
        const response = await fetch(url);
        const data = await response.json();
        
        if (data.mealServiceDietInfo && data.mealServiceDietInfo[1]) {
          const meals = data.mealServiceDietInfo[1].row;
          const lunchData = meals.find(meal => meal.MMEAL_SC_NM === 'ì¤‘ì‹') || meals[0];
          weekly.push({ date: currentDate, data: lunchData });
        } else {
          weekly.push({ date: currentDate, data: null });
        }
      } catch (error) {
        weekly.push({ date: currentDate, data: null });
      }
    }
    
    setWeeklyData(weekly);
    setLoading(false);
  };

  // ì„¤ì •ì—ì„œ í•™êµ ê²€ìƒ‰
  const searchSchoolsInSettings = async (name) => {
    if (!name || name.trim().length < 2) {
      setSettingsSearchResults([]);
      return;
    }
    setSettingsSearchLoading(true);
    try {
      const url = `https://open.neis.go.kr/hub/schoolInfo?KEY=${NEIS_API_KEY}&Type=json&pIndex=1&pSize=20&SCHUL_NM=${encodeURIComponent(name)}`;
      const response = await fetch(url);
      const data = await response.json();
      if (data.schoolInfo && data.schoolInfo[1]) {
        setSettingsSearchResults(data.schoolInfo[1].row);
      } else {
        setSettingsSearchResults([]);
      }
    } catch (error) {
      console.error('Error:', error);
      setSettingsSearchResults([]);
    }
    setSettingsSearchLoading(false);
  };

  // ì„¤ì •ì—ì„œ í•™êµ ì„ íƒ
  const selectSchoolInSettings = (school) => {
    const schoolData = {
      name: school.SCHUL_NM,
      officeCode: school.ATPT_OFCDC_SC_CODE,
      schoolCode: school.SD_SCHUL_CODE,
    };
    setSelectedSchool(schoolData);
    setSchoolName(school.SCHUL_NM);
    setSettingsSchoolInput(school.SCHUL_NM);
    setSettingsSearchResults([]);
    
    // ìë™ìœ¼ë¡œ ê¸°ë³¸ í•™êµë¡œ ì €ì¥
    localStorage.setItem('schoolLunchDefaultSchool', JSON.stringify(schoolData));
    alert(`âœ… ${schoolData.name}ì´(ê°€) ê¸°ë³¸ í•™êµë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!`);
    setShowSettings(false);
    setSettingsSchoolInput('');
  };

  return (
    <div className="min-h-screen p-3 sm:p-4 font-['Gowun_Dodum'] overflow-x-hidden" style={{
      position: 'relative'
    }}>
      {/* ë°°ê²½ ì´ë¯¸ì§€ (ì›ë³¸ ì„ ëª…ë„) */}
      <div style={{
        position: 'fixed',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        backgroundImage: 'url("./lunch-background.png")',
        backgroundSize: 'cover',
        backgroundPosition: 'center',
        backgroundRepeat: 'no-repeat',
        backgroundAttachment: 'fixed',
        pointerEvents: 'none',
        zIndex: 0
      }} />
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap');
        
        * {
          -webkit-tap-highlight-color: transparent;
          -webkit-touch-callout: none;
        }
        
        body {
          -webkit-user-select: none;
          user-select: none;
          overscroll-behavior: none;
        }
        
        input, button, textarea {
          -webkit-user-select: text;
          user-select: text;
        }
        
        .allergen {
          background-color: #FFE4E1;
          color: #DC143C;
          padding: 2px 6px;
          border-radius: 4px;
          font-weight: bold;
        }
        
        .meal-card {
          transition: all 0.3s ease;
          animation: fadeInUp 0.5s ease;
        }
        
        @media (hover: hover) {
          .meal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
          }
        }
        
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        .emoji-float {
          animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-10px); }
        }
        
        .gradient-text {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }
        
        @media (max-width: 640px) {
          .text-5xl { font-size: 2rem; }
          .text-4xl { font-size: 1.875rem; }
          .text-3xl { font-size: 1.5rem; }
          .text-2xl { font-size: 1.25rem; }
          .text-xl { font-size: 1rem; }
          .text-lg { font-size: 0.95rem; }
          .text-sm { font-size: 0.85rem; }
          .text-xs { font-size: 0.75rem; }
          
          .gap-3 { gap: 0.5rem; }
          .gap-4 { gap: 0.75rem; }
          .gap-6 { gap: 1rem; }
          .gap-8 { gap: 1.25rem; }
          
          .p-3 { padding: 0.5rem; }
          .p-4 { padding: 0.75rem; }
          .p-6 { padding: 1rem; }
          .p-8 { padding: 1.25rem; }
          .p-12 { padding: 1.5rem; }
          .p-16 { padding: 2rem; }
        }
      `}</style>

      <div className="max-w-6xl mx-auto relative" style={{ zIndex: 10 }}>
        {/* í—¤ë” */}
        <div className="text-center mb-6 sm:mb-8 pt-4 sm:pt-8 pb-4 sm:pb-6 px-4 sm:px-6 relative flex flex-col items-center">
          <div className="inline-block px-6 sm:px-12 py-4 sm:py-6 rounded-3xl shadow-2xl" style={{
            background: 'linear-gradient(135deg, rgba(147, 51, 234, 0.95) 0%, rgba(219, 39, 119, 0.95) 100%)',
            backdropFilter: 'blur(10px)',
            border: '2px solid rgba(255, 255, 255, 0.3)'
          }}>
            <h1 className="text-3xl sm:text-5xl font-bold text-white mb-2 sm:mb-3 flex items-center justify-center gap-2 sm:gap-3 flex-wrap">
              <span className="emoji-float">ğŸ±</span>
              <span>ë§›ìˆëŠ” ê¸‰ì‹</span>
              <span className="emoji-float" style={{animationDelay: '1s'}}>ğŸ±</span>
            </h1>
            <p className="text-white text-sm sm:text-lg">ì˜¤ëŠ˜ì˜ ì ì‹¬ ë©”ë‰´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>
          </div>
          
          <div className="absolute top-0 right-0 flex gap-2 sm:gap-3">
            <button
              onClick={() => { 
                setMealData(null); 
                setWeeklyData([]); 
                setViewMode('daily');
                setSelectedSchool(null);
                setSchoolName('');
                setSearchResults([]);
                setSelectedDate(new Date());
              }}
              className="bg-white p-2 sm:p-3 rounded-full shadow-lg active:shadow-md transition-all active:scale-95"
              title="ì´ˆê¸°í™”"
            >
              <span className="text-xl sm:text-2xl">ğŸ”„</span>
            </button>
            <button
              onClick={() => setShowSettings(true)}
              className="bg-white p-2 sm:p-3 rounded-full shadow-lg active:shadow-md transition-all active:scale-95"
              title="ì„¤ì •"
            >
              <span className="text-xl sm:text-2xl">âš™ï¸</span>
            </button>
            <button
              onClick={() => setShowInfo(true)}
              className="bg-white p-2 sm:p-3 rounded-full shadow-lg active:shadow-md transition-all active:scale-95"
              title="ì •ë³´"
            >
              <span className="text-xl sm:text-2xl">â„¹ï¸</span>
            </button>
          </div>
        </div>

        {/* ì„¤ì • ëª¨ë‹¬ */}
        {showSettings && (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 sm:p-4">
            <div className="bg-white rounded-3xl p-6 sm:p-8 max-w-md w-full shadow-2xl max-h-[90vh] overflow-y-auto">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold gradient-text">âš™ï¸ ì„¤ì •</h2>
                <button
                  onClick={() => {
                    setShowSettings(false);
                    setSettingsSearchResults([]);
                    setSettingsSchoolInput('');
                  }}
                  className="text-gray-500 hover:text-gray-700 text-2xl hover:rotate-90 transition-all"
                >
                  âœ•
                </button>
              </div>
              <div className="space-y-6">
                <div>
                  <label className="block text-lg font-bold mb-3 text-gray-700">í˜„ì¬ ì„ íƒëœ í•™êµ</label>
                  <div className="px-5 py-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border-2 border-purple-200 text-lg font-bold">
                    {selectedSchool ? `ğŸ« ${selectedSchool.name}` : 'ì„ íƒëœ í•™êµ ì—†ìŒ'}
                  </div>
                </div>
                
                <div className="relative">
                  <label className="block text-lg font-bold mb-3 text-gray-700">ğŸ” í•™êµ ê²€ìƒ‰ ë° ì„ íƒ</label>
                  <input
                    type="text"
                    value={settingsSchoolInput}
                    onChange={(e) => {
                      setSettingsSchoolInput(e.target.value);
                      searchSchoolsInSettings(e.target.value);
                    }}
                    placeholder="í•™êµëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ìë™ì™„ì„±)"
                    className="w-full px-5 py-4 border-2 border-purple-200 rounded-xl focus:outline-none focus:border-purple-400 text-lg"
                  />
                  
                  {settingsSearchLoading && (
                    <div className="absolute right-5 top-16 text-purple-600 font-bold">
                      <span className="animate-spin inline-block">ğŸ”</span> ê²€ìƒ‰ì¤‘...
                    </div>
                  )}
                  
                  {settingsSearchResults.length > 0 && (
                    <div className="mt-3 bg-white border-2 border-purple-200 rounded-xl shadow-xl max-h-60 overflow-y-auto">
                      {settingsSearchResults.map((school, idx) => (
                        <div
                          key={idx}
                          onClick={() => selectSchoolInSettings(school)}
                          className="px-5 py-4 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 cursor-pointer border-b last:border-b-0 transition-all"
                        >
                          <div className="font-bold text-lg text-gray-800 mb-1">ğŸ« {school.SCHUL_NM}</div>
                          <div className="text-sm text-gray-600">ğŸ“ {school.ORG_RDNMA || school.ORG_RDNZC}</div>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
                
                <div className="bg-gradient-to-r from-blue-50 to-purple-50 p-5 rounded-xl border-2 border-blue-200">
                  <p className="text-sm text-gray-700 leading-relaxed text-center">
                    ğŸ’¡ í•™êµë¥¼ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ê¸°ë³¸ í•™êµë¡œ ì €ì¥ë˜ì–´<br/>ë‹¤ìŒ ë°©ë¬¸ ì‹œ ìë™ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤
                  </p>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* ì •ë³´ ëª¨ë‹¬ */}
        {showInfo && (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 sm:p-4">
            <div className="bg-white rounded-3xl p-6 sm:p-8 max-w-md w-full shadow-2xl max-h-[90vh] overflow-y-auto">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold gradient-text">ë§Œë“  ì´</h2>
                <button
                  onClick={() => setShowInfo(false)}
                  className="text-gray-500 hover:text-gray-700 text-2xl hover:rotate-90 transition-all"
                >
                  âœ•
                </button>
              </div>
              <div className="space-y-4">
                <div className="text-center mb-6">
                  <div className="text-6xl mb-3">ğŸ±</div>
                  <h3 className="text-2xl font-bold gradient-text mb-2">ë§›ìˆëŠ” ê¸‰ì‹</h3>
                  <p className="text-gray-600 text-sm">í•™êµ ê¸‰ì‹ ì •ë³´ë¥¼ ì‰½ê³  ê°„í¸í•˜ê²Œ í™•ì¸í•˜ì„¸ìš”</p>
                </div>

                <div className="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-xl border-2 border-purple-200 text-center">
                  <p className="text-sm text-gray-700 leading-relaxed">
                    <strong>ë°°ì›€, ë‚˜ëˆ”, ì„±ì¥ì„ ì¶”êµ¬í•˜ëŠ” ì—°ê²°ì£¼ì˜ì</strong><br/>
                    <br/>
                    ë§›ìˆëŠ” ê¸‰ì‹, ê¹€ì§„ê´€(ë‹·ì»¤ë„¥í„°)<br/>
                    Â© All Rights Reserved
                  </p>
                </div>

                <div className="bg-gradient-to-r from-blue-50 to-cyan-50 p-4 rounded-xl border-2 border-blue-200 text-center">
                  <p className="text-sm text-gray-700 leading-relaxed mb-3">
                    <strong>ğŸ”— ë” ì•Œì•„ë³´ê¸°</strong>
                  </p>
                  <a 
                    href="https://litt.ly/dot_connector" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="inline-block w-full text-center bg-gradient-to-r from-blue-400 to-cyan-400 text-white py-2 px-4 rounded-xl font-bold hover:from-blue-500 hover:to-cyan-500 transition-all"
                  >
                    ë‹·ì»¤ë„¥í„° ë°©ë¬¸í•˜ê¸° â†’
                  </a>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */}
            <div className="rounded-3xl shadow-xl p-4 sm:p-6 mb-4 sm:mb-6" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4">
                {/* í•™êµ ê²€ìƒ‰ */}
                <div className="relative">
                  <label className="block text-sm font-medium mb-2 text-gray-700">ğŸ« í•™êµ ê²€ìƒ‰</label>
                  <input
                    type="text"
                    value={schoolName}
                    onChange={(e) => {
                      setSchoolName(e.target.value);
                      searchSchools(e.target.value);
                    }}
                    placeholder="í•™êµëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì„œìš¸ê³ ë“±í•™êµ)"
                    className="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:outline-none focus:border-purple-400"
                  />
                  {searchLoading && (
                    <div className="absolute right-4 top-11 text-purple-500">
                      ê²€ìƒ‰ì¤‘...
                    </div>
                  )}
                  
                  {/* ê²€ìƒ‰ ê²°ê³¼ ë“œë¡­ë‹¤ìš´ */}
                  {searchResults.length > 0 && (
                    <div className="absolute z-10 w-full mt-2 bg-white border-2 border-purple-200 rounded-xl shadow-xl max-h-60 overflow-y-auto">
                      {searchResults.map((school, idx) => (
                        <div
                          key={idx}
                          onClick={() => selectSchool(school)}
                          className="px-4 py-3 hover:bg-purple-50 cursor-pointer border-b border-gray-100 last:border-b-0"
                        >
                          <div className="font-bold text-gray-800">{school.SCHUL_NM}</div>
                          <div className="text-sm text-gray-600">
                            {school.ORG_RDNMA || school.ORG_RDNZC}
                          </div>
                          <div className="text-xs text-gray-500">
                            {school.ATPT_OFCDC_SC_NM}
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {selectedSchool && (
                    <div className="mt-2 px-3 py-2 bg-green-50 border-2 border-green-200 rounded-xl text-sm">
                      <strong className="text-green-700">âœ“ ì„ íƒë¨:</strong> {selectedSchool.name}
                    </div>
                  )}
                </div>
                
                {/* ë‚ ì§œ ì„ íƒ */}
                <div>
                  <label className="block text-sm font-medium mb-2 text-gray-700">ğŸ“… ë‚ ì§œ ì„ íƒ</label>
                  <input
                    type="date"
                    value={formatDateForInput(selectedDate)}
                    onChange={(e) => {
                      // ë¡œì»¬ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ìƒì„±
                      const [year, month, day] = e.target.value.split('-').map(Number);
                      const newDate = new Date(year, month - 1, day);
                      setSelectedDate(newDate);
                      if (viewMode === 'daily') {
                        fetchMealData(newDate);
                      }
                    }}
                    className="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:outline-none focus:border-purple-400"
                  />
                </div>
              </div>
              
              <div className="flex gap-2 sm:gap-4 mb-4 sm:mb-6">
                <button
                  onClick={async () => { 
                    setViewMode('daily'); 
                    setWeeklyData([]);
                    setMealData(null);
                    // ì•½ê°„ì˜ ì§€ì—° í›„ ë°ì´í„° ë¡œë“œ
                    setTimeout(() => {
                      fetchMealData(selectedDate);
                    }, 50);
                  }}
                  disabled={loading}
                  className={`flex-1 py-3 sm:py-4 px-2 sm:px-4 rounded-xl font-bold text-sm sm:text-lg transition-all active:scale-95 ${
                    viewMode === 'daily' 
                      ? 'bg-gradient-to-r from-purple-400 to-pink-400 text-white shadow-lg' 
                      : 'bg-gray-200 text-gray-700 active:bg-gray-300'
                  }`}
                >
                  ğŸ± ì¼ë³„ ê¸‰ì‹
                </button>
                <button
                  onClick={async () => { 
                    setViewMode('weekly'); 
                    setMealData(null);
                    setWeeklyData([]);
                    // ì•½ê°„ì˜ ì§€ì—° í›„ ë°ì´í„° ë¡œë“œ
                    setTimeout(() => {
                      fetchWeeklyData();
                    }, 50);
                  }}
                  disabled={loading}
                  className={`flex-1 py-3 sm:py-4 px-2 sm:px-4 rounded-xl font-bold text-sm sm:text-lg transition-all active:scale-95 ${
                    viewMode === 'weekly' 
                      ? 'bg-gradient-to-r from-purple-400 to-pink-400 text-white shadow-lg' 
                      : 'bg-gray-200 text-gray-700 active:bg-gray-300'
                  }`}
                >
                  ğŸ“… ì£¼ê°„ ê¸‰ì‹
                </button>
                
              </div>
            </div>


            {/* ë¡œë”© ì¤‘ */}
            {loading && (
              <div className="rounded-3xl shadow-xl p-8 sm:p-16 text-center" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
                <div className="text-5xl sm:text-7xl mb-4 sm:mb-6 float">ğŸ±</div>
                <p className="text-lg sm:text-2xl font-bold text-gray-600">ê¸‰ì‹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
              </div>
            )}

            {/* ì¼ë³„ ê¸‰ì‹ ì •ë³´ */}
            {viewMode === 'daily' && !loading && mealData && (
              <div className="space-y-4 sm:space-y-6 mb-4 sm:mb-6">
                {/* ë©”ë‰´ ì¹´ë“œ */}
                <div className="rounded-3xl shadow-xl p-6 sm:p-8 meal-card" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
                  <div className="flex justify-between items-start mb-4 sm:mb-6">
                    <div className="flex-1">
                      <h2 className="text-xl sm:text-3xl font-bold gradient-text mb-2">{mealData.SCHUL_NM}</h2>
                      <p className="text-xs sm:text-sm text-gray-600">
                        {selectedDate.toLocaleDateString('ko-KR', { 
                          year: 'numeric', 
                          month: 'long', 
                          day: 'numeric',
                          weekday: 'long'
                        })}
                      </p>
                    </div>
                    <div className="text-4xl emoji-float">ğŸ½ï¸</div>
                  </div>

                  <div className="space-y-4 mb-6">
                    <h3 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                      <span className="text-3xl">âœ¨</span>
                      ì˜¤ëŠ˜ì˜ ë©”ë‰´
                    </h3>
                    {mealData.DDISH_NM.split('<br/>').map((dish, idx) => {
                      const cleanDish = dish.replace(/\([^)]*\)/g, '').trim();
                      const emoji = getFoodEmoji(cleanDish);
                      return (
                        <div key={idx} className="flex items-start gap-3 p-3 bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl">
                          <span className="text-2xl">{emoji}</span>
                          <span 
                            className="text-lg flex-1"
                            dangerouslySetInnerHTML={{ __html: highlightAllergens(dish) }}
                          />
                        </div>
                      );
                    })}
                  </div>
                </div>

                {/* ì¹¼ë¡œë¦¬ ë° ì›ì‚°ì§€ ì •ë³´ */}
                <div className="rounded-3xl shadow-xl p-8" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
                  <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    {/* ì›ì‚°ì§€ ì •ë³´ */}
                    {mealData.ORPLC_INFO && (
                      <div className="lg:col-span-2">
                        <h3 className="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
                          <span className="text-2xl">ğŸŒ¾</span>
                          ì›ì‚°ì§€ ì •ë³´
                        </h3>
                        <div className="grid grid-cols-2 gap-2 text-sm text-gray-700">
                          {mealData.ORPLC_INFO.split('<br/>').map((origin, idx) => (
                            <div key={idx} className="p-2 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg">
                              {origin}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                    
                    {/* ì¹¼ë¡œë¦¬ */}
                    {mealData.CAL_INFO && (
                      <div className="text-center flex flex-col justify-center">
                        <h3 className="text-2xl font-bold mb-4 gradient-text">ğŸ”¥ ì¹¼ë¡œë¦¬</h3>
                        <div className="text-6xl font-bold text-orange-500">
                          {mealData.CAL_INFO.replace(' Kcal', '')}
                        </div>
                        <div className="text-xl text-gray-600 mt-2">Kcal</div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            )}

            {/* ê¸‰ì‹ ì •ë³´ ì—†ìŒ */}
            {viewMode === 'daily' && !loading && !mealData && selectedSchool && (
              <div className="rounded-3xl shadow-xl p-12 text-center" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
                <div className="text-6xl mb-4">ğŸ½ï¸</div>
                <p className="text-2xl font-bold text-gray-600 mb-2">ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                <p className="text-gray-500">ë‹¤ë¥¸ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
              </div>
            )}

            {/* ì£¼ê°„ ê¸‰ì‹ */}
            {viewMode === 'weekly' && weeklyData.length > 0 && (
              <div className="rounded-3xl shadow-xl p-6 mb-6" style={{ background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(254, 249, 240, 0.98) 100%)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255, 255, 255, 0.5)' }}>
                <h3 className="text-2xl font-bold mb-6 gradient-text flex items-center gap-2">
                  <span className="text-3xl">ğŸ“…</span>
                  ì´ë²ˆ ì£¼ ê¸‰ì‹
                </h3>
                <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
                  {weeklyData.map((item, idx) => (
                    <div 
                      key={idx}
                      className={`p-4 rounded-xl cursor-pointer transition-all ${
                        item.data 
                          ? 'bg-gradient-to-br from-pink-50 to-purple-50 hover:shadow-lg' 
                          : 'bg-gray-100'
                      }`}
                      onClick={() => item.data && setSelectedDate(item.date)}
                    >
                      <div className="text-center mb-2">
                        <div className="font-bold text-gray-800">
                          {item.date.toLocaleDateString('ko-KR', { weekday: 'short' })}
                        </div>
                        <div className="text-sm text-gray-600">
                          {item.date.getMonth() + 1}/{item.date.getDate()}
                        </div>
                      </div>
                      {item.data ? (
                        <div className="space-y-1">
                          {item.data.DDISH_NM.split('<br/>').map((dish, i) => {
                            const emoji = getFoodEmoji(dish);
                            return (
                              <div key={i} className="text-xs truncate flex items-center gap-1">
                                <span>{emoji}</span>
                                <span>{dish.replace(/\([^)]*\)/g, '')}</span>
                              </div>
                            );
                          })}
                        </div>
                      ) : (
                        <div className="text-xs text-gray-400 text-center">ê¸‰ì‹ì—†ìŒ</div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            )}

      </div>
    </div>
  );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SchoolLunchApp />);
    </script>
</body>
</html>
